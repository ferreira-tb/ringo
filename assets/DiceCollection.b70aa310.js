import{d as k,o as r,c as a,a as c,_ as F,s as T,r as j,l as B,k as N,H as R,b as _,n as h,u as i,i as L,F as O,j as z,T as U,e as w,t as b,p as V,h as J}from"./index.bd8e0be9.js";import{u as K,d as P}from"./objects.37df145e.js";import{o as q,e as G,R as H}from"./helpers.42634f98.js";import{B as x}from"./Button.d66cba2a.js";const Q={class:"file-input-wrapper"},W=["id"],X=k({__name:"FileInput",props:{id:null},emits:["fileUpload"],setup(l){return(f,n)=>(r(),a("div",Q,[c("input",{type:"file",accept:".json, application/json, text/json",id:l.id,onChange:n[0]||(n[0]=m=>f.$emit("fileUpload",m.target.files))},null,40,W)]))}});const Y=F(X,[["__scopeId","data-v-e486a0ba"]]),E=l=>(V("data-v-9db6cd4a"),l=l(),J(),l),Z={class:"menu-area"},M={key:0,class:"no-collection"},ee=E(()=>c("p",null,"N\xE3o h\xE1 rolagens salvas.",-1)),te=[ee],oe={key:1,class:"collection"},se=E(()=>c("h2",null,"Cole\xE7\xE3o",-1)),ne=["onClick"],ie={class:"bold"},le=k({__name:"DiceCollection",setup(l){const f=K(),{diceCollection:n}=f,{chosenDice:m,diceAmount:S,modifier:I,rollType:A}=T(f),y=j({width:"85%",height:"2em"}),g=B(()=>[...n.entries()].sort((e,t)=>e[0].localeCompare(t[0],"pt-br"))),d=N(null);R(d,async()=>{if(!(d.value instanceof FileList)||d.value.length===0)return;const o=new FileReader;for(const e of Array.from(d.value))await new Promise((t,p)=>{const s=new AbortController;o.addEventListener("load",v=>{D(v),s.abort(),t()},{signal:s.signal}),o.addEventListener("error",()=>{s.abort(),p()},{signal:s.signal}),o.readAsText(e)})});function $(o){m.value=o.dice,S.value=o.amount,I.value=o.modToSum,A.value=o.type,w.push({name:"dice"})}function D(o){var p;if(typeof((p=o.target)==null?void 0:p.result)!="string")return;const e=new H("O arquivo importado \xE9 inv\xE1lido."),t=JSON.parse(o.target.result);if(!Array.isArray(t))throw e;for(const s of t){if(!Array.isArray(s)||typeof s[0]!="string")throw e;const v=Object.entries(s[1]);for(const[u,C]of v)if(P.includes(u)){if((u==="text"||u==="type")&&typeof C!="string")throw e;if(u!=="text"&&u!=="type"&&typeof C!="number")throw e}else throw e;n.set(s[0],s[1])}}return(o,e)=>(r(),a("main",null,[c("div",Z,[_(Y,{id:"dice-collection",onFileUpload:e[0]||(e[0]=t=>d.value=t)}),_(x,{text:"Importar",style:h(y),onClick:e[1]||(e[1]=t=>i(q)("dice-collection"))},null,8,["style"]),_(x,{text:"Exportar",style:h(y),disabled:i(n).size===0,onClick:e[2]||(e[2]=t=>i(G)(i(g)))},null,8,["style","disabled"]),_(x,{text:"Voltar",style:h(y),onClick:e[3]||(e[3]=t=>i(w).push({name:"dice"}))},null,8,["style"])]),i(n).size===0?(r(),a("div",M,te)):(r(),a("div",oe,[se,_(U,{name:"list"},{default:L(()=>[(r(!0),a(O,null,z(i(g),t=>(r(),a("div",{class:"collection-item",onClick:p=>$(t[1])},[c("div",ie,b(t[0]),1),c("div",null,b(t[1].text),1)],8,ne))),256))]),_:1})]))]))}});const pe=F(le,[["__scopeId","data-v-9db6cd4a"]]);export{pe as default};
