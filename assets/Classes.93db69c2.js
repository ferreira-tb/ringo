import{d as B,u as M,h as y,D,G as V,I as F,o as c,c as i,b as r,l as N,J as I,F as _,m as b,e as p,w as v,a as d,j as T,A as g,T as j,p as L,g as R,q as C,t as k,r as $,_ as q}from"./index.023d8dab.js";import{R as z}from"./error.596be0a1.js";import{d as G}from"./game.967ee6ed.js";import{B as h}from"./Button.5faa71be.js";const f=u=>(L("data-v-32cff950"),u=u(),R(),u),H=f(()=>r("p",{class:"text-line"},"Classes descrevem a voca\xE7\xE3o de um personagem e suas aptid\xF5es especiais. Hora de escolher a sua.",-1)),J=f(()=>r("p",{class:"text-line small"},[C("Se ficar em d\xFAvida, apenas clique em "),r("span",{class:"bold"},"continuar"),C(".")],-1)),K=f(()=>r("p",{class:"text-line small"},"A Ringo escolher\xE1 uma classe aleat\xF3ria para voc\xEA.",-1)),P={class:"class-select-area"},U=["disabled","value"],O={class:"button-area"},Q={key:0,class:"class-info-area"},W=f(()=>r("h2",null,"Detalhes",-1)),X={class:"class-name-wrapper"},Y={key:0,class:"bold green span-wrapper"},Z=B({__name:"Classes",setup(u){const{character:n}=M(),{classes:w}=G(),o=y([]);n.books.forEach(a=>{const e=w.get(a);if(e)for(const[s,t]of e.entries())o.push([s,t,a])});const l=D(null),m=y(new Map),E=V(()=>o.length<1||typeof l.value!="number");o.length>0&&(Promise.all(n.books.map(async a=>{try{const e=await fetch(`/ringo/api/classes/book${a.toString(10)}.json`);if(e.status===404)return;const s=await e.json();Array.isArray(s)&&s.forEach(t=>m.set(t.codigo,t))}catch(e){e instanceof Error&&console.error(e)}})),o.sort((a,e)=>a[1].localeCompare(e[1],"pt-br")));function x(a,e,s=1){if(typeof a!="number"||typeof e!="number"){if(l.value===null)return;a=l.value;const t=o.find(A=>A[0]===a);if(!t)throw new z("N\xE3o foi poss\xEDvel encontrar a classe na lista.");e=t[2]}n.class.set(a,{book:e,level:s})}function S(){if(n.class.size===0){const a=Math.floor(Math.random()*o.length),e=typeof l.value=="number"?l.value:a;x(o[e][0],o[e][2])}}return F(()=>{const a=(s,t)=>t===s[0],e=new Set;for(const s of n.class.keys())o.some(t=>a(t,s))||e.add(s);e.forEach(s=>n.class.delete(s))}),(a,e)=>(c(),i("section",null,[H,J,K,r("div",P,[N(r("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s)},[(c(!0),i(_,null,b(o,s=>(c(),i("option",{key:s[0],disabled:d(n).class.has(s[0]),value:s[0]},k(s[1]),9,U))),128))],512),[[I,l.value,void 0,{number:!0}]])]),r("div",O,[p(h,{disabled:o.length<1,text:"Continuar",onClick:v(S,["prevent"])},null,8,["disabled","onClick"]),p(h,{disabled:d(E),text:"Adicionar classe",onClick:e[1]||(e[1]=v(s=>x(),["prevent"]))},null,8,["disabled"]),p(h,{text:"Voltar",onClick:e[2]||(e[2]=v(s=>d($).push({name:"create-char-step-2"}),["prevent"]))})]),p(j,{name:"fade",mode:"out-in"},{default:T(()=>[d(n).class.size>0?(c(),i("div",Q,[W,r("div",X,[(c(!0),i(_,null,b(d(n).class,s=>{var t;return c(),i(_,{key:s[0]},[m.has(s[0])?(c(),i("span",Y,k((t=m.get(s[0]))==null?void 0:t.nome),1)):g("",!0)],64)}),128))])])):g("",!0)]),_:1})]))}});const oe=q(Z,[["__scopeId","data-v-32cff950"]]);export{oe as default};
