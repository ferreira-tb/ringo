import{d as k,o as r,c,a as l,_ as F,s as T,r as j,l as B,k as L,m as N,b as _,n as h,u as i,i as R,F as O,j as z,T as U,e as b,t as g,p as V,h as J}from"./index.d294f8f8.js";import{u as K,d as P}from"./objects.df4299b3.js";import{o as q,e as G,R as H}from"./helpers.da37dee5.js";import{B as x}from"./Button.d2bce5d1.js";const Q={class:"file-input-wrapper"},W=["id"],X=k({__name:"FileInput",props:{id:null},emits:["fileUpload"],setup(a){return(f,n)=>(r(),c("div",Q,[l("input",{type:"file",accept:".json, application/json, text/json",id:a.id,onChange:n[0]||(n[0]=m=>f.$emit("fileUpload",m.target.files))},null,40,W)]))}});const Y=F(X,[["__scopeId","data-v-e486a0ba"]]),S=a=>(V("data-v-6ef105bf"),a=a(),J(),a),Z={class:"menu-area"},M={key:0,class:"no-collection"},ee=S(()=>l("p",null,"N\xE3o h\xE1 rolagens salvas.",-1)),te=[ee],oe={key:1,class:"collection"},se=S(()=>l("h2",null,"Cole\xE7\xE3o",-1)),ne=["onClick"],ie={class:"bold item-name"},le=k({__name:"DiceCollection",setup(a){const f=K(),{diceCollection:n}=f,{chosenDice:m,diceAmount:E,modifier:I,rollType:A}=T(f),y=j({width:"85%",height:"2em"}),C=B(()=>[...n.entries()].sort((e,t)=>e[0].localeCompare(t[0],"pt-br"))),d=L(null);N(d,async()=>{if(!(d.value instanceof FileList)||d.value.length===0)return;const o=new FileReader;for(const e of Array.from(d.value))await new Promise((t,p)=>{const s=new AbortController;o.addEventListener("load",v=>{$(v),s.abort(),t()},{signal:s.signal}),o.addEventListener("error",()=>{s.abort(),p()},{signal:s.signal}),o.readAsText(e)})});function D(o){m.value=o.dice,E.value=o.amount,I.value=o.modToSum,A.value=o.type,b.push({name:"dice"})}function $(o){var p;if(typeof((p=o.target)==null?void 0:p.result)!="string")return;const e=new H("O arquivo importado \xE9 inv\xE1lido."),t=JSON.parse(o.target.result);if(!Array.isArray(t))throw e;for(const s of t){if(!Array.isArray(s)||typeof s[0]!="string")throw e;const v=Object.entries(s[1]);for(const[u,w]of v)if(P.includes(u)){if((u==="text"||u==="type")&&typeof w!="string")throw e;if(u!=="text"&&u!=="type"&&typeof w!="number")throw e}else throw e;n.set(s[0],s[1])}}return(o,e)=>(r(),c("main",null,[l("div",Z,[_(Y,{id:"dice-collection",onFileUpload:e[0]||(e[0]=t=>d.value=t)}),_(x,{text:"Importar",style:h(y),onClick:e[1]||(e[1]=t=>i(q)("dice-collection"))},null,8,["style"]),_(x,{text:"Exportar",style:h(y),disabled:i(n).size===0,onClick:e[2]||(e[2]=t=>i(G)(i(C)))},null,8,["style","disabled"]),_(x,{text:"Voltar",style:h(y),onClick:e[3]||(e[3]=t=>i(b).push({name:"dice"}))},null,8,["style"])]),i(n).size===0?(r(),c("div",M,te)):(r(),c("div",oe,[se,_(U,{name:"list"},{default:R(()=>[(r(!0),c(O,null,z(i(C),t=>(r(),c("div",{class:"collection-item",onClick:p=>D(t[1])},[l("span",ie,g(t[0]),1),l("span",null,g(t[1].text),1),l("span",null,g(new Date(t[1].date).toLocaleDateString()),1)],8,ne))),256))]),_:1})]))]))}});const pe=F(le,[["__scopeId","data-v-6ef105bf"]]);export{pe as default};
