import{d as E,c as r,b as c,o as a,_ as F,s as T,q as B,h as N,g as R,G as j,a as _,A as h,u as i,w as L,T as O,C as w,F as z,r as P,t as b,p as U,e as V}from"./index.d6d4da8b.js";import{u as q,B as g,o as G,e as J,R as K,d as H}from"./Button.e8626672.js";const Q={class:"file-input-wrapper"},W=["id"],X=E({__name:"FileInput",props:{id:null},emits:["fileUpload"],setup(l){return(f,n)=>(a(),r("div",Q,[c("input",{type:"file",accept:".json, application/json, text/json",id:l.id,onChange:n[0]||(n[0]=m=>f.$emit("fileUpload",m.target.files))},null,40,W)]))}});const Y=F(X,[["__scopeId","data-v-e486a0ba"]]),k=l=>(U("data-v-4c2f481e"),l=l(),V(),l),Z={class:"menu-area"},M=k(()=>c("h2",null,"Cole\xE7\xE3o",-1)),ee={key:0,class:"no-collection"},te=k(()=>c("p",null,"N\xE3o h\xE1 rolagens salvas.",-1)),oe=[te],se={key:1,class:"collection"},ne=["onClick"],ie={class:"bold"},le=E({__name:"DiceCollection",setup(l){const f=q(),{diceCollection:n}=f,{chosenDice:m,diceAmount:S,modifier:I,rollType:A}=T(f),y=B({width:"85%",height:"2em"}),x=N(()=>[...n.entries()].sort((e,o)=>e[0].localeCompare(o[0],"pt-br"))),d=R(null);j(d,async()=>{if(d.value instanceof FileList&&d.value.length!==0)try{const t=new FileReader;await Promise.all(Array.from(d.value).map(e=>new Promise((o,p)=>{const s=new AbortController;t.addEventListener("load",v=>{D(v),s.abort(),o()},{signal:s.signal}),t.addEventListener("error",()=>{s.abort(),p()},{signal:s.signal}),t.readAsText(e)})))}catch(t){t instanceof Error&&console.error(t)}});function $(t){m.value=t.dice,S.value=t.amount,I.value=t.modToSum,A.value=t.type,w.push({name:"home"})}function D(t){var p;if(typeof((p=t.target)==null?void 0:p.result)!="string")return;const e=new K("O arquivo importado \xE9 inv\xE1lido."),o=JSON.parse(t.target.result);if(!Array.isArray(o))throw e;for(const s of o){if(!Array.isArray(s)||typeof s[0]!="string")throw e;const v=Object.entries(s[1]);for(const[u,C]of v)if(H.includes(u)){if((u==="text"||u==="type")&&typeof C!="string")throw e;if(u!=="text"&&u!=="type"&&typeof C!="number")throw e}else throw e;n.set(s[0],s[1])}}return(t,e)=>(a(),r("main",null,[c("div",Z,[_(Y,{id:"dice-collection",onFileUpload:e[0]||(e[0]=o=>d.value=o)}),_(g,{text:"Importar",style:h(y),onClick:e[1]||(e[1]=o=>i(G)("dice-collection"))},null,8,["style"]),_(g,{text:"Exportar",style:h(y),disabled:i(n).size===0,onClick:e[2]||(e[2]=o=>i(J)(i(x)))},null,8,["style","disabled"]),_(g,{text:"Voltar",style:h(y),onClick:e[3]||(e[3]=o=>i(w).push({name:"dice"}))},null,8,["style"])]),M,i(n).size===0?(a(),r("div",ee,oe)):(a(),r("div",se,[_(O,{name:"list"},{default:L(()=>[(a(!0),r(z,null,P(i(x),o=>(a(),r("div",{class:"collection-item",onClick:p=>$(o[1])},[c("div",ie,b(o[0]),1),c("div",null,b(o[1].text),1)],8,ne))),256))]),_:1})]))]))}});const ce=F(le,[["__scopeId","data-v-4c2f481e"]]);export{ce as default};
